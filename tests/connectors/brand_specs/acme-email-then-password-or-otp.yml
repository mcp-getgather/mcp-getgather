name: ACME

auth:
  fields:
    - name: email
      type: text
      prompt: Please enter your email address
      selector: input[type=email]
    - name: password
      type: password
      prompt: Please enter your password
      selector: input[type=password]
    - name: otp
      type: text
      prompt: Please enter your one-time code
      selector: input[type=text]
    - name: submit
      prompt: Continue
      type: click
      selector: form button[type=submit]
      expect_nav: true
    - name: log in
      prompt: Log in with password
      type: click
      selector: button:has-text("Log in")
      expect_nav: true
    - name: otp_choice_button
      type: click
      prompt: Use a one-time code instead
      selector: button:has-text("Use a one-time code instead")
      expect_nav: true
    - name: welcome
      type: wait
      selector: p:has-text("Welcome")

  pages:
    - name: Email form
      url: http://localhost:5001/auth/email-then-pass-or-otp
      fields: [email, submit]

    - name: Password form
      choices:
        name: verification_choice
        prompt: Would you like to use a password or a one-time code?
        groups:
          - name: password
            prompt: Password
            fields: [password, log in]
          - name: otp
            prompt: One-time code
            fields: [otp_choice_button]

    - name: OTP form
      fields: [otp, submit]

    - name: Welcome page
      fields: [welcome]
      end: true

  start: Email form
