name: ACME

auth:
  fields:
    - name: email
      type: text
      prompt: Please enter your email address
      selector: input[type=email]
    - name: password
      type: password
      prompt: Please enter your password
      selector: input[type=password]
    - name: email_mfa_choice
      type: click
      prompt: Get code by email
      selector: input[type=radio][name="delivery_method"][value="EMAIL"]
    - name: sms_mfa_choice
      type: click
      prompt: Get code by text message
      selector: input[type=radio][name="delivery_method"][value="SMS"]
    - name: mfa_code
      type: text
      label: div:has-text("We sent a code to:")
      prompt: Enter your code
      selector: input[type=text][name="otp"]
    - name: submit
      type: click
      prompt: Submit
      selector: form button[type=submit]
      expect_nav: true
    - name: welcome
      type: wait
      selector: p:has-text("Welcome")

  pages:
    - name: Email form
      url: http://localhost:5001/auth/email-then-password-then-mfa-choice-phone-email
      fields: [email, submit]

    - name: Password form
      fields: [password, submit]
    - name: MFA choice form
      choices:
        name: MFA_choice
        prompt: How should we send your code?
        groups:
          - name: email
            prompt: Email
            fields: [email_mfa_choice, submit]
          - name: phone
            prompt: Text message
            fields: [sms_mfa_choice, submit]
  # todo add dynamic prompt for the actual email or phone number

    - name: MFA code form
      fields: [mfa_code, submit]

    - name: Welcome page
      fields: [welcome]
      end: true

  start: Email form
