<html gg-domain="traveloka" gg-priority="2">
  <head>
    <title>Traveloka Sign In</title>
  </head>
  <body>
    <input
      autofocus
      name="pass"
      type="password"
      gg-match="input[data-testid='auth-password']"
      data-testid="gg-auth-password"
      placeholder="Password"
    />
    <button
      data-testid="gg-loginBtn"
      type="submit"
      gg-autoclick
      gg-match="[data-testid='loginBtn']"
    >
      Sign in
    </button>
    <script>
      // 1st attempt: keep as is; 2nd attempt: disable inputs and soft-refresh after 5s.
      document.addEventListener("DOMContentLoaded", function () {
        const pwdInput = document.querySelector("input[data-testid='gg-auth-password']");
        const submitBtn = document.querySelector("[data-testid='gg-loginBtn']");
        if (!pwdInput || !submitBtn) return;

        const attemptKey = "gg_traveloka_signin_password_attempt";
        const attempt = Number(sessionStorage.getItem(attemptKey) || "0") + 1;
        sessionStorage.setItem(attemptKey, String(attempt));

        if (attempt >= 2) {
          pwdInput.disabled = true;
          submitBtn.disabled = true;
          submitBtn.setAttribute("aria-busy", "true");
          submitBtn.setAttribute("aria-disabled", "true");
          submitBtn.textContent = "Loading...";
          setTimeout(function () {
            sessionStorage.removeItem(attemptKey);
            window.location.reload();
          }, 5000);
        }
      });
    </script>
  </body>
</html>
