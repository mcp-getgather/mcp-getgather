name: Audible
auth:
  fields:
    - name: sign_in
      type: autoclick
      prompt: Sign In
      selector: nav a:has-text("Sign In")
    - name: email
      type: text
      prompt: Email
      selector: input#ap_email
    - name: email_continue
      type: click
      prompt: Email Continue
      selector: input#continue
    - name: password
      type: password
      prompt: Password
      selector: input#ap_password
    - name: remember_me
      type: autoclick
      prompt: Remember me
      selector: input[type=checkbox][name=rememberMe]
    - name: sign_in_submit
      type: click
      prompt: Sign In
      selector: input#signInSubmit
    - name: cart
      type: wait
      selector: div.navigation-header-cart
  pages:
    - name: Go to Sign in page
      fields: [sign_in]
    - name: Fill in email
      fields: [email, email_continue]
    - name: Fill in password
      fields: [password, remember_me, sign_in_submit]
    - name: Confirm sign in
      fields: [cart]
      end: true
  start: https://www.audible.com/
extract:
  steps:
    - name: Go to Library
      url: https://www.audible.com/library/titles
    - name: Extract the list of titles
      bundle: library.html
      slurp_selector: div#adbl-library-content-main
parse:
  - bundle: library.html
    format: html
    output: library.json
    row_selector: div.adbl-library-content-row
    columns:
      - name: cover
        selector: img
        attribute: src
      - name: title
        selector: span.bc-size-headline3
      - name: author
        selector: span.authorLabel a
      - name: url
        selector: a.bc-link
        attribute: href
