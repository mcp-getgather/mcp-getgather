name: Doordash
signin:
  fields:
    - name: email
      type: text
      prompt: Email
      selector: input[data-anchor-id="IdentityLoginPageEmailField"]
    - name: email_continue
      type: click
      prompt: Continue
      selector: button#guided-submit-button
    - name: confirm_phone
      type: text
      selector: input[type="tel"]
      prompt: Phone number
      label: span:has-text("Enter the phone ending in")
    - name: confirm_phone_message
      type: message
      selector: span:has-text("Enter the phone ending in")
      label: span:has-text("Enter the phone ending in")
    - name: confirm_phone_continue
      type: click
      prompt: Continue
      selector: button[kind="BUTTON/PRIMARY"]
      exact_text: Continue
    - name: password
      type: password
      prompt: Password
      selector: input[data-anchor-id="IdentityLoginPagePasswordField"]
    - name: password_submit
      type: click
      prompt: Sign In
      selector: button#login-submit-button
    - name: otp
      type: text_multi
      prompt: 6-digit one time code
      selector: input[type="number"]
  pages:
    - name: Email page
      fields: [email, email_continue]
    - name: Phone confirmation page
      fields: [confirm_phone, confirm_phone_message, confirm_phone_continue]
    - name: Password page
      fields: [password, password_submit]
    - name: OTP page
      fields: [otp]
    - name: Orders page
      url: https://www.doordash.com/orders
      end: true
  start: https://www.doordash.com/orders
extract:
  steps:
    - name: Go to orders page
      url: https://www.doordash.com/orders
    - name: Extract the orders
      bundle: orders.html
      slurp_selector: div[data-testid="OrdersV2"]
parse:
  - bundle: orders.html
    format: html
    output: orders.json
    row_selector: div[data-testid="OrdersCompletedSection"]
    columns:
      - name: restaurant
        selector: a[href^="/store/"]
      - name: restaurant_url
        selector: a[href^="/store/"]
        attribute: href
      - name: description
        selector: div.order-detail-body-wrapper div div div
