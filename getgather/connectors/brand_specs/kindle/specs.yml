name: Kindle
auth:
  fields:
    - name: email
      type: text
      prompt: Email
      selector: input#ap_email
    - name: password
      type: password
      prompt: Password
      selector: input#ap_password
    - name: sign_in
      type: click
      prompt: Sign In
      selector: input#signInSubmit
    - name: content_page_title
      type: wait
      selector: div#content-page-title
  pages:
    - name: Sign in page
      fields: [email, password, sign_in]
    - name: Content page
      fields: [content_page_title]
      end: true
  start: https://www.amazon.com/hz/mycd/digital-console/contentlist/booksAll/dateDsc/
extract:
  steps:
    - name: Go to Content page
      url: https://www.amazon.com/hz/mycd/digital-console/contentlist/booksAll/dateDsc/
    - name: Extract the list of books
      bundle: books.html
      slurp_selector: div#CONTENT_LIST
parse:
  - bundle: books.html
    format: html
    output: books.json
    row_selector: td > div
    columns:
      - name: cover
        selector: div[id^=content-image-] img
        attribute: src
      - name: title
        selector: div[id^=content-title-]
      - name: author
        selector: div[id^=content-author-]
